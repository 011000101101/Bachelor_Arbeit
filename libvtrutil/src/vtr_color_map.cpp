#include <cmath>
#include "vtr_color_map.h"
#include "vtr_assert.h"

namespace vtr {

//Inferno data from MatPlotLib
static std::vector<std::tuple<float,float,float>> inferno_data = {
        std::make_tuple(0.001462, 0.000466, 0.013866),
        std::make_tuple(0.002267, 0.001270, 0.018570),
        std::make_tuple(0.003299, 0.002249, 0.024239),
        std::make_tuple(0.004547, 0.003392, 0.030909),
        std::make_tuple(0.006006, 0.004692, 0.038558),
        std::make_tuple(0.007676, 0.006136, 0.046836),
        std::make_tuple(0.009561, 0.007713, 0.055143),
        std::make_tuple(0.011663, 0.009417, 0.063460),
        std::make_tuple(0.013995, 0.011225, 0.071862),
        std::make_tuple(0.016561, 0.013136, 0.080282),
        std::make_tuple(0.019373, 0.015133, 0.088767),
        std::make_tuple(0.022447, 0.017199, 0.097327),
        std::make_tuple(0.025793, 0.019331, 0.105930),
        std::make_tuple(0.029432, 0.021503, 0.114621),
        std::make_tuple(0.033385, 0.023702, 0.123397),
        std::make_tuple(0.037668, 0.025921, 0.132232),
        std::make_tuple(0.042253, 0.028139, 0.141141),
        std::make_tuple(0.046915, 0.030324, 0.150164),
        std::make_tuple(0.051644, 0.032474, 0.159254),
        std::make_tuple(0.056449, 0.034569, 0.168414),
        std::make_tuple(0.061340, 0.036590, 0.177642),
        std::make_tuple(0.066331, 0.038504, 0.186962),
        std::make_tuple(0.071429, 0.040294, 0.196354),
        std::make_tuple(0.076637, 0.041905, 0.205799),
        std::make_tuple(0.081962, 0.043328, 0.215289),
        std::make_tuple(0.087411, 0.044556, 0.224813),
        std::make_tuple(0.092990, 0.045583, 0.234358),
        std::make_tuple(0.098702, 0.046402, 0.243904),
        std::make_tuple(0.104551, 0.047008, 0.253430),
        std::make_tuple(0.110536, 0.047399, 0.262912),
        std::make_tuple(0.116656, 0.047574, 0.272321),
        std::make_tuple(0.122908, 0.047536, 0.281624),
        std::make_tuple(0.129285, 0.047293, 0.290788),
        std::make_tuple(0.135778, 0.046856, 0.299776),
        std::make_tuple(0.142378, 0.046242, 0.308553),
        std::make_tuple(0.149073, 0.045468, 0.317085),
        std::make_tuple(0.155850, 0.044559, 0.325338),
        std::make_tuple(0.162689, 0.043554, 0.333277),
        std::make_tuple(0.169575, 0.042489, 0.340874),
        std::make_tuple(0.176493, 0.041402, 0.348111),
        std::make_tuple(0.183429, 0.040329, 0.354971),
        std::make_tuple(0.190367, 0.039309, 0.361447),
        std::make_tuple(0.197297, 0.038400, 0.367535),
        std::make_tuple(0.204209, 0.037632, 0.373238),
        std::make_tuple(0.211095, 0.037030, 0.378563),
        std::make_tuple(0.217949, 0.036615, 0.383522),
        std::make_tuple(0.224763, 0.036405, 0.388129),
        std::make_tuple(0.231538, 0.036405, 0.392400),
        std::make_tuple(0.238273, 0.036621, 0.396353),
        std::make_tuple(0.244967, 0.037055, 0.400007),
        std::make_tuple(0.251620, 0.037705, 0.403378),
        std::make_tuple(0.258234, 0.038571, 0.406485),
        std::make_tuple(0.264810, 0.039647, 0.409345),
        std::make_tuple(0.271347, 0.040922, 0.411976),
        std::make_tuple(0.277850, 0.042353, 0.414392),
        std::make_tuple(0.284321, 0.043933, 0.416608),
        std::make_tuple(0.290763, 0.045644, 0.418637),
        std::make_tuple(0.297178, 0.047470, 0.420491),
        std::make_tuple(0.303568, 0.049396, 0.422182),
        std::make_tuple(0.309935, 0.051407, 0.423721),
        std::make_tuple(0.316282, 0.053490, 0.425116),
        std::make_tuple(0.322610, 0.055634, 0.426377),
        std::make_tuple(0.328921, 0.057827, 0.427511),
        std::make_tuple(0.335217, 0.060060, 0.428524),
        std::make_tuple(0.341500, 0.062325, 0.429425),
        std::make_tuple(0.347771, 0.064616, 0.430217),
        std::make_tuple(0.354032, 0.066925, 0.430906),
        std::make_tuple(0.360284, 0.069247, 0.431497),
        std::make_tuple(0.366529, 0.071579, 0.431994),
        std::make_tuple(0.372768, 0.073915, 0.432400),
        std::make_tuple(0.379001, 0.076253, 0.432719),
        std::make_tuple(0.385228, 0.078591, 0.432955),
        std::make_tuple(0.391453, 0.080927, 0.433109),
        std::make_tuple(0.397674, 0.083257, 0.433183),
        std::make_tuple(0.403894, 0.085580, 0.433179),
        std::make_tuple(0.410113, 0.087896, 0.433098),
        std::make_tuple(0.416331, 0.090203, 0.432943),
        std::make_tuple(0.422549, 0.092501, 0.432714),
        std::make_tuple(0.428768, 0.094790, 0.432412),
        std::make_tuple(0.434987, 0.097069, 0.432039),
        std::make_tuple(0.441207, 0.099338, 0.431594),
        std::make_tuple(0.447428, 0.101597, 0.431080),
        std::make_tuple(0.453651, 0.103848, 0.430498),
        std::make_tuple(0.459875, 0.106089, 0.429846),
        std::make_tuple(0.466100, 0.108322, 0.429125),
        std::make_tuple(0.472328, 0.110547, 0.428334),
        std::make_tuple(0.478558, 0.112764, 0.427475),
        std::make_tuple(0.484789, 0.114974, 0.426548),
        std::make_tuple(0.491022, 0.117179, 0.425552),
        std::make_tuple(0.497257, 0.119379, 0.424488),
        std::make_tuple(0.503493, 0.121575, 0.423356),
        std::make_tuple(0.509730, 0.123769, 0.422156),
        std::make_tuple(0.515967, 0.125960, 0.420887),
        std::make_tuple(0.522206, 0.128150, 0.419549),
        std::make_tuple(0.528444, 0.130341, 0.418142),
        std::make_tuple(0.534683, 0.132534, 0.416667),
        std::make_tuple(0.540920, 0.134729, 0.415123),
        std::make_tuple(0.547157, 0.136929, 0.413511),
        std::make_tuple(0.553392, 0.139134, 0.411829),
        std::make_tuple(0.559624, 0.141346, 0.410078),
        std::make_tuple(0.565854, 0.143567, 0.408258),
        std::make_tuple(0.572081, 0.145797, 0.406369),
        std::make_tuple(0.578304, 0.148039, 0.404411),
        std::make_tuple(0.584521, 0.150294, 0.402385),
        std::make_tuple(0.590734, 0.152563, 0.400290),
        std::make_tuple(0.596940, 0.154848, 0.398125),
        std::make_tuple(0.603139, 0.157151, 0.395891),
        std::make_tuple(0.609330, 0.159474, 0.393589),
        std::make_tuple(0.615513, 0.161817, 0.391219),
        std::make_tuple(0.621685, 0.164184, 0.388781),
        std::make_tuple(0.627847, 0.166575, 0.386276),
        std::make_tuple(0.633998, 0.168992, 0.383704),
        std::make_tuple(0.640135, 0.171438, 0.381065),
        std::make_tuple(0.646260, 0.173914, 0.378359),
        std::make_tuple(0.652369, 0.176421, 0.375586),
        std::make_tuple(0.658463, 0.178962, 0.372748),
        std::make_tuple(0.664540, 0.181539, 0.369846),
        std::make_tuple(0.670599, 0.184153, 0.366879),
        std::make_tuple(0.676638, 0.186807, 0.363849),
        std::make_tuple(0.682656, 0.189501, 0.360757),
        std::make_tuple(0.688653, 0.192239, 0.357603),
        std::make_tuple(0.694627, 0.195021, 0.354388),
        std::make_tuple(0.700576, 0.197851, 0.351113),
        std::make_tuple(0.706500, 0.200728, 0.347777),
        std::make_tuple(0.712396, 0.203656, 0.344383),
        std::make_tuple(0.718264, 0.206636, 0.340931),
        std::make_tuple(0.724103, 0.209670, 0.337424),
        std::make_tuple(0.729909, 0.212759, 0.333861),
        std::make_tuple(0.735683, 0.215906, 0.330245),
        std::make_tuple(0.741423, 0.219112, 0.326576),
        std::make_tuple(0.747127, 0.222378, 0.322856),
        std::make_tuple(0.752794, 0.225706, 0.319085),
        std::make_tuple(0.758422, 0.229097, 0.315266),
        std::make_tuple(0.764010, 0.232554, 0.311399),
        std::make_tuple(0.769556, 0.236077, 0.307485),
        std::make_tuple(0.775059, 0.239667, 0.303526),
        std::make_tuple(0.780517, 0.243327, 0.299523),
        std::make_tuple(0.785929, 0.247056, 0.295477),
        std::make_tuple(0.791293, 0.250856, 0.291390),
        std::make_tuple(0.796607, 0.254728, 0.287264),
        std::make_tuple(0.801871, 0.258674, 0.283099),
        std::make_tuple(0.807082, 0.262692, 0.278898),
        std::make_tuple(0.812239, 0.266786, 0.274661),
        std::make_tuple(0.817341, 0.270954, 0.270390),
        std::make_tuple(0.822386, 0.275197, 0.266085),
        std::make_tuple(0.827372, 0.279517, 0.261750),
        std::make_tuple(0.832299, 0.283913, 0.257383),
        std::make_tuple(0.837165, 0.288385, 0.252988),
        std::make_tuple(0.841969, 0.292933, 0.248564),
        std::make_tuple(0.846709, 0.297559, 0.244113),
        std::make_tuple(0.851384, 0.302260, 0.239636),
        std::make_tuple(0.855992, 0.307038, 0.235133),
        std::make_tuple(0.860533, 0.311892, 0.230606),
        std::make_tuple(0.865006, 0.316822, 0.226055),
        std::make_tuple(0.869409, 0.321827, 0.221482),
        std::make_tuple(0.873741, 0.326906, 0.216886),
        std::make_tuple(0.878001, 0.332060, 0.212268),
        std::make_tuple(0.882188, 0.337287, 0.207628),
        std::make_tuple(0.886302, 0.342586, 0.202968),
        std::make_tuple(0.890341, 0.347957, 0.198286),
        std::make_tuple(0.894305, 0.353399, 0.193584),
        std::make_tuple(0.898192, 0.358911, 0.188860),
        std::make_tuple(0.902003, 0.364492, 0.184116),
        std::make_tuple(0.905735, 0.370140, 0.179350),
        std::make_tuple(0.909390, 0.375856, 0.174563),
        std::make_tuple(0.912966, 0.381636, 0.169755),
        std::make_tuple(0.916462, 0.387481, 0.164924),
        std::make_tuple(0.919879, 0.393389, 0.160070),
        std::make_tuple(0.923215, 0.399359, 0.155193),
        std::make_tuple(0.926470, 0.405389, 0.150292),
        std::make_tuple(0.929644, 0.411479, 0.145367),
        std::make_tuple(0.932737, 0.417627, 0.140417),
        std::make_tuple(0.935747, 0.423831, 0.135440),
        std::make_tuple(0.938675, 0.430091, 0.130438),
        std::make_tuple(0.941521, 0.436405, 0.125409),
        std::make_tuple(0.944285, 0.442772, 0.120354),
        std::make_tuple(0.946965, 0.449191, 0.115272),
        std::make_tuple(0.949562, 0.455660, 0.110164),
        std::make_tuple(0.952075, 0.462178, 0.105031),
        std::make_tuple(0.954506, 0.468744, 0.099874),
        std::make_tuple(0.956852, 0.475356, 0.094695),
        std::make_tuple(0.959114, 0.482014, 0.089499),
        std::make_tuple(0.961293, 0.488716, 0.084289),
        std::make_tuple(0.963387, 0.495462, 0.079073),
        std::make_tuple(0.965397, 0.502249, 0.073859),
        std::make_tuple(0.967322, 0.509078, 0.068659),
        std::make_tuple(0.969163, 0.515946, 0.063488),
        std::make_tuple(0.970919, 0.522853, 0.058367),
        std::make_tuple(0.972590, 0.529798, 0.053324),
        std::make_tuple(0.974176, 0.536780, 0.048392),
        std::make_tuple(0.975677, 0.543798, 0.043618),
        std::make_tuple(0.977092, 0.550850, 0.039050),
        std::make_tuple(0.978422, 0.557937, 0.034931),
        std::make_tuple(0.979666, 0.565057, 0.031409),
        std::make_tuple(0.980824, 0.572209, 0.028508),
        std::make_tuple(0.981895, 0.579392, 0.026250),
        std::make_tuple(0.982881, 0.586606, 0.024661),
        std::make_tuple(0.983779, 0.593849, 0.023770),
        std::make_tuple(0.984591, 0.601122, 0.023606),
        std::make_tuple(0.985315, 0.608422, 0.024202),
        std::make_tuple(0.985952, 0.615750, 0.025592),
        std::make_tuple(0.986502, 0.623105, 0.027814),
        std::make_tuple(0.986964, 0.630485, 0.030908),
        std::make_tuple(0.987337, 0.637890, 0.034916),
        std::make_tuple(0.987622, 0.645320, 0.039886),
        std::make_tuple(0.987819, 0.652773, 0.045581),
        std::make_tuple(0.987926, 0.660250, 0.051750),
        std::make_tuple(0.987945, 0.667748, 0.058329),
        std::make_tuple(0.987874, 0.675267, 0.065257),
        std::make_tuple(0.987714, 0.682807, 0.072489),
        std::make_tuple(0.987464, 0.690366, 0.079990),
        std::make_tuple(0.987124, 0.697944, 0.087731),
        std::make_tuple(0.986694, 0.705540, 0.095694),
        std::make_tuple(0.986175, 0.713153, 0.103863),
        std::make_tuple(0.985566, 0.720782, 0.112229),
        std::make_tuple(0.984865, 0.728427, 0.120785),
        std::make_tuple(0.984075, 0.736087, 0.129527),
        std::make_tuple(0.983196, 0.743758, 0.138453),
        std::make_tuple(0.982228, 0.751442, 0.147565),
        std::make_tuple(0.981173, 0.759135, 0.156863),
        std::make_tuple(0.980032, 0.766837, 0.166353),
        std::make_tuple(0.978806, 0.774545, 0.176037),
        std::make_tuple(0.977497, 0.782258, 0.185923),
        std::make_tuple(0.976108, 0.789974, 0.196018),
        std::make_tuple(0.974638, 0.797692, 0.206332),
        std::make_tuple(0.973088, 0.805409, 0.216877),
        std::make_tuple(0.971468, 0.813122, 0.227658),
        std::make_tuple(0.969783, 0.820825, 0.238686),
        std::make_tuple(0.968041, 0.828515, 0.249972),
        std::make_tuple(0.966243, 0.836191, 0.261534),
        std::make_tuple(0.964394, 0.843848, 0.273391),
        std::make_tuple(0.962517, 0.851476, 0.285546),
        std::make_tuple(0.960626, 0.859069, 0.298010),
        std::make_tuple(0.958720, 0.866624, 0.310820),
        std::make_tuple(0.956834, 0.874129, 0.323974),
        std::make_tuple(0.954997, 0.881569, 0.337475),
        std::make_tuple(0.953215, 0.888942, 0.351369),
        std::make_tuple(0.951546, 0.896226, 0.365627),
        std::make_tuple(0.950018, 0.903409, 0.380271),
        std::make_tuple(0.948683, 0.910473, 0.395289),
        std::make_tuple(0.947594, 0.917399, 0.410665),
        std::make_tuple(0.946809, 0.924168, 0.426373),
        std::make_tuple(0.946392, 0.930761, 0.442367),
        std::make_tuple(0.946403, 0.937159, 0.458592),
        std::make_tuple(0.946903, 0.943348, 0.474970),
        std::make_tuple(0.947937, 0.949318, 0.491426),
        std::make_tuple(0.949545, 0.955063, 0.507860),
        std::make_tuple(0.951740, 0.960587, 0.524203),
        std::make_tuple(0.954529, 0.965896, 0.540361),
        std::make_tuple(0.957896, 0.971003, 0.556275),
        std::make_tuple(0.961812, 0.975924, 0.571925),
        std::make_tuple(0.966249, 0.980678, 0.587206),
        std::make_tuple(0.971162, 0.985282, 0.602154),
        std::make_tuple(0.976511, 0.989753, 0.616760),
        std::make_tuple(0.982257, 0.994109, 0.631017),
        std::make_tuple(0.988362, 0.998364, 0.644924) };

//Plasma data from MatPlotLib
static std::vector<std::tuple<float,float,float>> plasma_data = {
       std::make_tuple(5.03832136e-02, 2.98028976e-02, 5.27974883e-01),
       std::make_tuple(6.35363639e-02, 2.84259729e-02, 5.33123681e-01),
       std::make_tuple(7.53531234e-02, 2.72063728e-02, 5.38007001e-01),
       std::make_tuple(8.62217979e-02, 2.61253206e-02, 5.42657691e-01),
       std::make_tuple(9.63786097e-02, 2.51650976e-02, 5.47103487e-01),
       std::make_tuple(1.05979704e-01, 2.43092436e-02, 5.51367851e-01),
       std::make_tuple(1.15123641e-01, 2.35562500e-02, 5.55467728e-01),
       std::make_tuple(1.23902903e-01, 2.28781011e-02, 5.59423480e-01),
       std::make_tuple(1.32380720e-01, 2.22583774e-02, 5.63250116e-01),
       std::make_tuple(1.40603076e-01, 2.16866674e-02, 5.66959485e-01),
       std::make_tuple(1.48606527e-01, 2.11535876e-02, 5.70561711e-01),
       std::make_tuple(1.56420649e-01, 2.06507174e-02, 5.74065446e-01),
       std::make_tuple(1.64069722e-01, 2.01705326e-02, 5.77478074e-01),
       std::make_tuple(1.71573925e-01, 1.97063415e-02, 5.80805890e-01),
       std::make_tuple(1.78950212e-01, 1.92522243e-02, 5.84054243e-01),
       std::make_tuple(1.86212958e-01, 1.88029767e-02, 5.87227661e-01),
       std::make_tuple(1.93374449e-01, 1.83540593e-02, 5.90329954e-01),
       std::make_tuple(2.00445260e-01, 1.79015512e-02, 5.93364304e-01),
       std::make_tuple(2.07434551e-01, 1.74421086e-02, 5.96333341e-01),
       std::make_tuple(2.14350298e-01, 1.69729276e-02, 5.99239207e-01),
       std::make_tuple(2.21196750e-01, 1.64970484e-02, 6.02083323e-01),
       std::make_tuple(2.27982971e-01, 1.60071509e-02, 6.04867403e-01),
       std::make_tuple(2.34714537e-01, 1.55015065e-02, 6.07592438e-01),
       std::make_tuple(2.41396253e-01, 1.49791041e-02, 6.10259089e-01),
       std::make_tuple(2.48032377e-01, 1.44393586e-02, 6.12867743e-01),
       std::make_tuple(2.54626690e-01, 1.38820918e-02, 6.15418537e-01),
       std::make_tuple(2.61182562e-01, 1.33075156e-02, 6.17911385e-01),
       std::make_tuple(2.67702993e-01, 1.27162163e-02, 6.20345997e-01),
       std::make_tuple(2.74190665e-01, 1.21091423e-02, 6.22721903e-01),
       std::make_tuple(2.80647969e-01, 1.14875915e-02, 6.25038468e-01),
       std::make_tuple(2.87076059e-01, 1.08554862e-02, 6.27294975e-01),
       std::make_tuple(2.93477695e-01, 1.02128849e-02, 6.29490490e-01),
       std::make_tuple(2.99855122e-01, 9.56079551e-03, 6.31623923e-01),
       std::make_tuple(3.06209825e-01, 8.90185346e-03, 6.33694102e-01),
       std::make_tuple(3.12543124e-01, 8.23900704e-03, 6.35699759e-01),
       std::make_tuple(3.18856183e-01, 7.57551051e-03, 6.37639537e-01),
       std::make_tuple(3.25150025e-01, 6.91491734e-03, 6.39512001e-01),
       std::make_tuple(3.31425547e-01, 6.26107379e-03, 6.41315649e-01),
       std::make_tuple(3.37683446e-01, 5.61830889e-03, 6.43048936e-01),
       std::make_tuple(3.43924591e-01, 4.99053080e-03, 6.44710195e-01),
       std::make_tuple(3.50149699e-01, 4.38202557e-03, 6.46297711e-01),
       std::make_tuple(3.56359209e-01, 3.79781761e-03, 6.47809772e-01),
       std::make_tuple(3.62553473e-01, 3.24319591e-03, 6.49244641e-01),
       std::make_tuple(3.68732762e-01, 2.72370721e-03, 6.50600561e-01),
       std::make_tuple(3.74897270e-01, 2.24514897e-03, 6.51875762e-01),
       std::make_tuple(3.81047116e-01, 1.81356205e-03, 6.53068467e-01),
       std::make_tuple(3.87182639e-01, 1.43446923e-03, 6.54176761e-01),
       std::make_tuple(3.93304010e-01, 1.11388259e-03, 6.55198755e-01),
       std::make_tuple(3.99410821e-01, 8.59420809e-04, 6.56132835e-01),
       std::make_tuple(4.05502914e-01, 6.78091517e-04, 6.56977276e-01),
       std::make_tuple(4.11580082e-01, 5.77101735e-04, 6.57730380e-01),
       std::make_tuple(4.17642063e-01, 5.63847476e-04, 6.58390492e-01),
       std::make_tuple(4.23688549e-01, 6.45902780e-04, 6.58956004e-01),
       std::make_tuple(4.29719186e-01, 8.31008207e-04, 6.59425363e-01),
       std::make_tuple(4.35733575e-01, 1.12705875e-03, 6.59797077e-01),
       std::make_tuple(4.41732123e-01, 1.53984779e-03, 6.60069009e-01),
       std::make_tuple(4.47713600e-01, 2.07954744e-03, 6.60240367e-01),
       std::make_tuple(4.53677394e-01, 2.75470302e-03, 6.60309966e-01),
       std::make_tuple(4.59622938e-01, 3.57374415e-03, 6.60276655e-01),
       std::make_tuple(4.65549631e-01, 4.54518084e-03, 6.60139383e-01),
       std::make_tuple(4.71456847e-01, 5.67758762e-03, 6.59897210e-01),
       std::make_tuple(4.77343929e-01, 6.97958743e-03, 6.59549311e-01),
       std::make_tuple(4.83210198e-01, 8.45983494e-03, 6.59094989e-01),
       std::make_tuple(4.89054951e-01, 1.01269996e-02, 6.58533677e-01),
       std::make_tuple(4.94877466e-01, 1.19897486e-02, 6.57864946e-01),
       std::make_tuple(5.00677687e-01, 1.40550640e-02, 6.57087561e-01),
       std::make_tuple(5.06454143e-01, 1.63333443e-02, 6.56202294e-01),
       std::make_tuple(5.12206035e-01, 1.88332232e-02, 6.55209222e-01),
       std::make_tuple(5.17932580e-01, 2.15631918e-02, 6.54108545e-01),
       std::make_tuple(5.23632990e-01, 2.45316468e-02, 6.52900629e-01),
       std::make_tuple(5.29306474e-01, 2.77468735e-02, 6.51586010e-01),
       std::make_tuple(5.34952244e-01, 3.12170300e-02, 6.50165396e-01),
       std::make_tuple(5.40569510e-01, 3.49501310e-02, 6.48639668e-01),
       std::make_tuple(5.46157494e-01, 3.89540334e-02, 6.47009884e-01),
       std::make_tuple(5.51715423e-01, 4.31364795e-02, 6.45277275e-01),
       std::make_tuple(5.57242538e-01, 4.73307585e-02, 6.43443250e-01),
       std::make_tuple(5.62738096e-01, 5.15448092e-02, 6.41509389e-01),
       std::make_tuple(5.68201372e-01, 5.57776706e-02, 6.39477440e-01),
       std::make_tuple(5.73631859e-01, 6.00281369e-02, 6.37348841e-01),
       std::make_tuple(5.79028682e-01, 6.42955547e-02, 6.35126108e-01),
       std::make_tuple(5.84391137e-01, 6.85790261e-02, 6.32811608e-01),
       std::make_tuple(5.89718606e-01, 7.28775875e-02, 6.30407727e-01),
       std::make_tuple(5.95010505e-01, 7.71902878e-02, 6.27916992e-01),
       std::make_tuple(6.00266283e-01, 8.15161895e-02, 6.25342058e-01),
       std::make_tuple(6.05485428e-01, 8.58543713e-02, 6.22685703e-01),
       std::make_tuple(6.10667469e-01, 9.02039303e-02, 6.19950811e-01),
       std::make_tuple(6.15811974e-01, 9.45639838e-02, 6.17140367e-01),
       std::make_tuple(6.20918555e-01, 9.89336721e-02, 6.14257440e-01),
       std::make_tuple(6.25986869e-01, 1.03312160e-01, 6.11305174e-01),
       std::make_tuple(6.31016615e-01, 1.07698641e-01, 6.08286774e-01),
       std::make_tuple(6.36007543e-01, 1.12092335e-01, 6.05205491e-01),
       std::make_tuple(6.40959444e-01, 1.16492495e-01, 6.02064611e-01),
       std::make_tuple(6.45872158e-01, 1.20898405e-01, 5.98867442e-01),
       std::make_tuple(6.50745571e-01, 1.25309384e-01, 5.95617300e-01),
       std::make_tuple(6.55579615e-01, 1.29724785e-01, 5.92317494e-01),
       std::make_tuple(6.60374266e-01, 1.34143997e-01, 5.88971318e-01),
       std::make_tuple(6.65129493e-01, 1.38566428e-01, 5.85582301e-01),
       std::make_tuple(6.69845385e-01, 1.42991540e-01, 5.82153572e-01),
       std::make_tuple(6.74522060e-01, 1.47418835e-01, 5.78688247e-01),
       std::make_tuple(6.79159664e-01, 1.51847851e-01, 5.75189431e-01),
       std::make_tuple(6.83758384e-01, 1.56278163e-01, 5.71660158e-01),
       std::make_tuple(6.88318440e-01, 1.60709387e-01, 5.68103380e-01),
       std::make_tuple(6.92840088e-01, 1.65141174e-01, 5.64521958e-01),
       std::make_tuple(6.97323615e-01, 1.69573215e-01, 5.60918659e-01),
       std::make_tuple(7.01769334e-01, 1.74005236e-01, 5.57296144e-01),
       std::make_tuple(7.06177590e-01, 1.78437000e-01, 5.53656970e-01),
       std::make_tuple(7.10548747e-01, 1.82868306e-01, 5.50003579e-01),
       std::make_tuple(7.14883195e-01, 1.87298986e-01, 5.46338299e-01),
       std::make_tuple(7.19181339e-01, 1.91728906e-01, 5.42663338e-01),
       std::make_tuple(7.23443604e-01, 1.96157962e-01, 5.38980786e-01),
       std::make_tuple(7.27670428e-01, 2.00586086e-01, 5.35292612e-01),
       std::make_tuple(7.31862231e-01, 2.05013174e-01, 5.31600995e-01),
       std::make_tuple(7.36019424e-01, 2.09439071e-01, 5.27908434e-01),
       std::make_tuple(7.40142557e-01, 2.13863965e-01, 5.24215533e-01),
       std::make_tuple(7.44232102e-01, 2.18287899e-01, 5.20523766e-01),
       std::make_tuple(7.48288533e-01, 2.22710942e-01, 5.16834495e-01),
       std::make_tuple(7.52312321e-01, 2.27133187e-01, 5.13148963e-01),
       std::make_tuple(7.56303937e-01, 2.31554749e-01, 5.09468305e-01),
       std::make_tuple(7.60263849e-01, 2.35975765e-01, 5.05793543e-01),
       std::make_tuple(7.64192516e-01, 2.40396394e-01, 5.02125599e-01),
       std::make_tuple(7.68090391e-01, 2.44816813e-01, 4.98465290e-01),
       std::make_tuple(7.71957916e-01, 2.49237220e-01, 4.94813338e-01),
       std::make_tuple(7.75795522e-01, 2.53657797e-01, 4.91170517e-01),
       std::make_tuple(7.79603614e-01, 2.58078397e-01, 4.87539124e-01),
       std::make_tuple(7.83382636e-01, 2.62499662e-01, 4.83917732e-01),
       std::make_tuple(7.87132978e-01, 2.66921859e-01, 4.80306702e-01),
       std::make_tuple(7.90855015e-01, 2.71345267e-01, 4.76706319e-01),
       std::make_tuple(7.94549101e-01, 2.75770179e-01, 4.73116798e-01),
       std::make_tuple(7.98215577e-01, 2.80196901e-01, 4.69538286e-01),
       std::make_tuple(8.01854758e-01, 2.84625750e-01, 4.65970871e-01),
       std::make_tuple(8.05466945e-01, 2.89057057e-01, 4.62414580e-01),
       std::make_tuple(8.09052419e-01, 2.93491117e-01, 4.58869577e-01),
       std::make_tuple(8.12611506e-01, 2.97927865e-01, 4.55337565e-01),
       std::make_tuple(8.16144382e-01, 3.02368130e-01, 4.51816385e-01),
       std::make_tuple(8.19651255e-01, 3.06812282e-01, 4.48305861e-01),
       std::make_tuple(8.23132309e-01, 3.11260703e-01, 4.44805781e-01),
       std::make_tuple(8.26587706e-01, 3.15713782e-01, 4.41315901e-01),
       std::make_tuple(8.30017584e-01, 3.20171913e-01, 4.37835947e-01),
       std::make_tuple(8.33422053e-01, 3.24635499e-01, 4.34365616e-01),
       std::make_tuple(8.36801237e-01, 3.29104836e-01, 4.30905052e-01),
       std::make_tuple(8.40155276e-01, 3.33580106e-01, 4.27454836e-01),
       std::make_tuple(8.43484103e-01, 3.38062109e-01, 4.24013059e-01),
       std::make_tuple(8.46787726e-01, 3.42551272e-01, 4.20579333e-01),
       std::make_tuple(8.50066132e-01, 3.47048028e-01, 4.17153264e-01),
       std::make_tuple(8.53319279e-01, 3.51552815e-01, 4.13734445e-01),
       std::make_tuple(8.56547103e-01, 3.56066072e-01, 4.10322469e-01),
       std::make_tuple(8.59749520e-01, 3.60588229e-01, 4.06916975e-01),
       std::make_tuple(8.62926559e-01, 3.65119408e-01, 4.03518809e-01),
       std::make_tuple(8.66077920e-01, 3.69660446e-01, 4.00126027e-01),
       std::make_tuple(8.69203436e-01, 3.74211795e-01, 3.96738211e-01),
       std::make_tuple(8.72302917e-01, 3.78773910e-01, 3.93354947e-01),
       std::make_tuple(8.75376149e-01, 3.83347243e-01, 3.89975832e-01),
       std::make_tuple(8.78422895e-01, 3.87932249e-01, 3.86600468e-01),
       std::make_tuple(8.81442916e-01, 3.92529339e-01, 3.83228622e-01),
       std::make_tuple(8.84435982e-01, 3.97138877e-01, 3.79860246e-01),
       std::make_tuple(8.87401682e-01, 4.01761511e-01, 3.76494232e-01),
       std::make_tuple(8.90339687e-01, 4.06397694e-01, 3.73130228e-01),
       std::make_tuple(8.93249647e-01, 4.11047871e-01, 3.69767893e-01),
       std::make_tuple(8.96131191e-01, 4.15712489e-01, 3.66406907e-01),
       std::make_tuple(8.98983931e-01, 4.20391986e-01, 3.63046965e-01),
       std::make_tuple(9.01807455e-01, 4.25086807e-01, 3.59687758e-01),
       std::make_tuple(9.04601295e-01, 4.29797442e-01, 3.56328796e-01),
       std::make_tuple(9.07364995e-01, 4.34524335e-01, 3.52969777e-01),
       std::make_tuple(9.10098088e-01, 4.39267908e-01, 3.49610469e-01),
       std::make_tuple(9.12800095e-01, 4.44028574e-01, 3.46250656e-01),
       std::make_tuple(9.15470518e-01, 4.48806744e-01, 3.42890148e-01),
       std::make_tuple(9.18108848e-01, 4.53602818e-01, 3.39528771e-01),
       std::make_tuple(9.20714383e-01, 4.58417420e-01, 3.36165582e-01),
       std::make_tuple(9.23286660e-01, 4.63250828e-01, 3.32800827e-01),
       std::make_tuple(9.25825146e-01, 4.68103387e-01, 3.29434512e-01),
       std::make_tuple(9.28329275e-01, 4.72975465e-01, 3.26066550e-01),
       std::make_tuple(9.30798469e-01, 4.77867420e-01, 3.22696876e-01),
       std::make_tuple(9.33232140e-01, 4.82779603e-01, 3.19325444e-01),
       std::make_tuple(9.35629684e-01, 4.87712357e-01, 3.15952211e-01),
       std::make_tuple(9.37990034e-01, 4.92666544e-01, 3.12575440e-01),
       std::make_tuple(9.40312939e-01, 4.97642038e-01, 3.09196628e-01),
       std::make_tuple(9.42597771e-01, 5.02639147e-01, 3.05815824e-01),
       std::make_tuple(9.44843893e-01, 5.07658169e-01, 3.02433101e-01),
       std::make_tuple(9.47050662e-01, 5.12699390e-01, 2.99048555e-01),
       std::make_tuple(9.49217427e-01, 5.17763087e-01, 2.95662308e-01),
       std::make_tuple(9.51343530e-01, 5.22849522e-01, 2.92274506e-01),
       std::make_tuple(9.53427725e-01, 5.27959550e-01, 2.88883445e-01),
       std::make_tuple(9.55469640e-01, 5.33093083e-01, 2.85490391e-01),
       std::make_tuple(9.57468770e-01, 5.38250172e-01, 2.82096149e-01),
       std::make_tuple(9.59424430e-01, 5.43431038e-01, 2.78700990e-01),
       std::make_tuple(9.61335930e-01, 5.48635890e-01, 2.75305214e-01),
       std::make_tuple(9.63202573e-01, 5.53864931e-01, 2.71909159e-01),
       std::make_tuple(9.65023656e-01, 5.59118349e-01, 2.68513200e-01),
       std::make_tuple(9.66798470e-01, 5.64396327e-01, 2.65117752e-01),
       std::make_tuple(9.68525639e-01, 5.69699633e-01, 2.61721488e-01),
       std::make_tuple(9.70204593e-01, 5.75028270e-01, 2.58325424e-01),
       std::make_tuple(9.71835007e-01, 5.80382015e-01, 2.54931256e-01),
       std::make_tuple(9.73416145e-01, 5.85761012e-01, 2.51539615e-01),
       std::make_tuple(9.74947262e-01, 5.91165394e-01, 2.48151200e-01),
       std::make_tuple(9.76427606e-01, 5.96595287e-01, 2.44766775e-01),
       std::make_tuple(9.77856416e-01, 6.02050811e-01, 2.41387186e-01),
       std::make_tuple(9.79232922e-01, 6.07532077e-01, 2.38013359e-01),
       std::make_tuple(9.80556344e-01, 6.13039190e-01, 2.34646316e-01),
       std::make_tuple(9.81825890e-01, 6.18572250e-01, 2.31287178e-01),
       std::make_tuple(9.83040742e-01, 6.24131362e-01, 2.27937141e-01),
       std::make_tuple(9.84198924e-01, 6.29717516e-01, 2.24595006e-01),
       std::make_tuple(9.85300760e-01, 6.35329876e-01, 2.21264889e-01),
       std::make_tuple(9.86345421e-01, 6.40968508e-01, 2.17948456e-01),
       std::make_tuple(9.87332067e-01, 6.46633475e-01, 2.14647532e-01),
       std::make_tuple(9.88259846e-01, 6.52324832e-01, 2.11364122e-01),
       std::make_tuple(9.89127893e-01, 6.58042630e-01, 2.08100426e-01),
       std::make_tuple(9.89935328e-01, 6.63786914e-01, 2.04858855e-01),
       std::make_tuple(9.90681261e-01, 6.69557720e-01, 2.01642049e-01),
       std::make_tuple(9.91364787e-01, 6.75355082e-01, 1.98452900e-01),
       std::make_tuple(9.91984990e-01, 6.81179025e-01, 1.95294567e-01),
       std::make_tuple(9.92540939e-01, 6.87029567e-01, 1.92170500e-01),
       std::make_tuple(9.93031693e-01, 6.92906719e-01, 1.89084459e-01),
       std::make_tuple(9.93456302e-01, 6.98810484e-01, 1.86040537e-01),
       std::make_tuple(9.93813802e-01, 7.04740854e-01, 1.83043180e-01),
       std::make_tuple(9.94103226e-01, 7.10697814e-01, 1.80097207e-01),
       std::make_tuple(9.94323596e-01, 7.16681336e-01, 1.77207826e-01),
       std::make_tuple(9.94473934e-01, 7.22691379e-01, 1.74380656e-01),
       std::make_tuple(9.94553260e-01, 7.28727890e-01, 1.71621733e-01),
       std::make_tuple(9.94560594e-01, 7.34790799e-01, 1.68937522e-01),
       std::make_tuple(9.94494964e-01, 7.40880020e-01, 1.66334918e-01),
       std::make_tuple(9.94355411e-01, 7.46995448e-01, 1.63821243e-01),
       std::make_tuple(9.94140989e-01, 7.53136955e-01, 1.61404226e-01),
       std::make_tuple(9.93850778e-01, 7.59304390e-01, 1.59091984e-01),
       std::make_tuple(9.93482190e-01, 7.65498551e-01, 1.56890625e-01),
       std::make_tuple(9.93033251e-01, 7.71719833e-01, 1.54807583e-01),
       std::make_tuple(9.92505214e-01, 7.77966775e-01, 1.52854862e-01),
       std::make_tuple(9.91897270e-01, 7.84239120e-01, 1.51041581e-01),
       std::make_tuple(9.91208680e-01, 7.90536569e-01, 1.49376885e-01),
       std::make_tuple(9.90438793e-01, 7.96858775e-01, 1.47869810e-01),
       std::make_tuple(9.89587065e-01, 8.03205337e-01, 1.46529128e-01),
       std::make_tuple(9.88647741e-01, 8.09578605e-01, 1.45357284e-01),
       std::make_tuple(9.87620557e-01, 8.15977942e-01, 1.44362644e-01),
       std::make_tuple(9.86509366e-01, 8.22400620e-01, 1.43556679e-01),
       std::make_tuple(9.85314198e-01, 8.28845980e-01, 1.42945116e-01),
       std::make_tuple(9.84031139e-01, 8.35315360e-01, 1.42528388e-01),
       std::make_tuple(9.82652820e-01, 8.41811730e-01, 1.42302653e-01),
       std::make_tuple(9.81190389e-01, 8.48328902e-01, 1.42278607e-01),
       std::make_tuple(9.79643637e-01, 8.54866468e-01, 1.42453425e-01),
       std::make_tuple(9.77994918e-01, 8.61432314e-01, 1.42808191e-01),
       std::make_tuple(9.76264977e-01, 8.68015998e-01, 1.43350944e-01),
       std::make_tuple(9.74443038e-01, 8.74622194e-01, 1.44061156e-01),
       std::make_tuple(9.72530009e-01, 8.81250063e-01, 1.44922913e-01),
       std::make_tuple(9.70532932e-01, 8.87896125e-01, 1.45918663e-01),
       std::make_tuple(9.68443477e-01, 8.94563989e-01, 1.47014438e-01),
       std::make_tuple(9.66271225e-01, 9.01249365e-01, 1.48179639e-01),
       std::make_tuple(9.64021057e-01, 9.07950379e-01, 1.49370428e-01),
       std::make_tuple(9.61681481e-01, 9.14672479e-01, 1.50520343e-01),
       std::make_tuple(9.59275646e-01, 9.21406537e-01, 1.51566019e-01),
       std::make_tuple(9.56808068e-01, 9.28152065e-01, 1.52409489e-01),
       std::make_tuple(9.54286813e-01, 9.34907730e-01, 1.52921158e-01),
       std::make_tuple(9.51726083e-01, 9.41670605e-01, 1.52925363e-01),
       std::make_tuple(9.49150533e-01, 9.48434900e-01, 1.52177604e-01),
       std::make_tuple(9.46602270e-01, 9.55189860e-01, 1.50327944e-01),
       std::make_tuple(9.44151742e-01, 9.61916487e-01, 1.46860789e-01),
       std::make_tuple(9.41896120e-01, 9.68589814e-01, 1.40955606e-01),
       std::make_tuple(9.40015097e-01, 9.75158357e-01, 1.31325517e-01)};

//Viridis data from MatPlotLib
static std::vector<std::tuple<float,float,float>> viridis_data = {
       std::make_tuple(0.26700401, 0.00487433, 0.32941519),
       std::make_tuple(0.26851048, 0.00960483, 0.33542652),
       std::make_tuple(0.26994384, 0.01462494, 0.34137895),
       std::make_tuple(0.27130489, 0.01994186, 0.34726862),
       std::make_tuple(0.27259384, 0.02556309, 0.35309303),
       std::make_tuple(0.27380934, 0.03149748, 0.35885256),
       std::make_tuple(0.27495242, 0.03775181, 0.36454323),
       std::make_tuple(0.27602238, 0.04416723, 0.37016418),
       std::make_tuple(0.2770184 , 0.05034437, 0.37571452),
       std::make_tuple(0.27794143, 0.05632444, 0.38119074),
       std::make_tuple(0.27879067, 0.06214536, 0.38659204),
       std::make_tuple(0.2795655 , 0.06783587, 0.39191723),
       std::make_tuple(0.28026658, 0.07341724, 0.39716349),
       std::make_tuple(0.28089358, 0.07890703, 0.40232944),
       std::make_tuple(0.28144581, 0.0843197 , 0.40741404),
       std::make_tuple(0.28192358, 0.08966622, 0.41241521),
       std::make_tuple(0.28232739, 0.09495545, 0.41733086),
       std::make_tuple(0.28265633, 0.10019576, 0.42216032),
       std::make_tuple(0.28291049, 0.10539345, 0.42690202),
       std::make_tuple(0.28309095, 0.11055307, 0.43155375),
       std::make_tuple(0.28319704, 0.11567966, 0.43611482),
       std::make_tuple(0.28322882, 0.12077701, 0.44058404),
       std::make_tuple(0.28318684, 0.12584799, 0.44496   ),
       std::make_tuple(0.283072  , 0.13089477, 0.44924127),
       std::make_tuple(0.28288389, 0.13592005, 0.45342734),
       std::make_tuple(0.28262297, 0.14092556, 0.45751726),
       std::make_tuple(0.28229037, 0.14591233, 0.46150995),
       std::make_tuple(0.28188676, 0.15088147, 0.46540474),
       std::make_tuple(0.28141228, 0.15583425, 0.46920128),
       std::make_tuple(0.28086773, 0.16077132, 0.47289909),
       std::make_tuple(0.28025468, 0.16569272, 0.47649762),
       std::make_tuple(0.27957399, 0.17059884, 0.47999675),
       std::make_tuple(0.27882618, 0.1754902 , 0.48339654),
       std::make_tuple(0.27801236, 0.18036684, 0.48669702),
       std::make_tuple(0.27713437, 0.18522836, 0.48989831),
       std::make_tuple(0.27619376, 0.19007447, 0.49300074),
       std::make_tuple(0.27519116, 0.1949054 , 0.49600488),
       std::make_tuple(0.27412802, 0.19972086, 0.49891131),
       std::make_tuple(0.27300596, 0.20452049, 0.50172076),
       std::make_tuple(0.27182812, 0.20930306, 0.50443413),
       std::make_tuple(0.27059473, 0.21406899, 0.50705243),
       std::make_tuple(0.26930756, 0.21881782, 0.50957678),
       std::make_tuple(0.26796846, 0.22354911, 0.5120084 ),
       std::make_tuple(0.26657984, 0.2282621 , 0.5143487 ),
       std::make_tuple(0.2651445 , 0.23295593, 0.5165993 ),
       std::make_tuple(0.2636632 , 0.23763078, 0.51876163),
       std::make_tuple(0.26213801, 0.24228619, 0.52083736),
       std::make_tuple(0.26057103, 0.2469217 , 0.52282822),
       std::make_tuple(0.25896451, 0.25153685, 0.52473609),
       std::make_tuple(0.25732244, 0.2561304 , 0.52656332),
       std::make_tuple(0.25564519, 0.26070284, 0.52831152),
       std::make_tuple(0.25393498, 0.26525384, 0.52998273),
       std::make_tuple(0.25219404, 0.26978306, 0.53157905),
       std::make_tuple(0.25042462, 0.27429024, 0.53310261),
       std::make_tuple(0.24862899, 0.27877509, 0.53455561),
       std::make_tuple(0.2468114 , 0.28323662, 0.53594093),
       std::make_tuple(0.24497208, 0.28767547, 0.53726018),
       std::make_tuple(0.24311324, 0.29209154, 0.53851561),
       std::make_tuple(0.24123708, 0.29648471, 0.53970946),
       std::make_tuple(0.23934575, 0.30085494, 0.54084398),
       std::make_tuple(0.23744138, 0.30520222, 0.5419214 ),
       std::make_tuple(0.23552606, 0.30952657, 0.54294396),
       std::make_tuple(0.23360277, 0.31382773, 0.54391424),
       std::make_tuple(0.2316735 , 0.3181058 , 0.54483444),
       std::make_tuple(0.22973926, 0.32236127, 0.54570633),
       std::make_tuple(0.22780192, 0.32659432, 0.546532  ),
       std::make_tuple(0.2258633 , 0.33080515, 0.54731353),
       std::make_tuple(0.22392515, 0.334994  , 0.54805291),
       std::make_tuple(0.22198915, 0.33916114, 0.54875211),
       std::make_tuple(0.22005691, 0.34330688, 0.54941304),
       std::make_tuple(0.21812995, 0.34743154, 0.55003755),
       std::make_tuple(0.21620971, 0.35153548, 0.55062743),
       std::make_tuple(0.21429757, 0.35561907, 0.5511844 ),
       std::make_tuple(0.21239477, 0.35968273, 0.55171011),
       std::make_tuple(0.2105031 , 0.36372671, 0.55220646),
       std::make_tuple(0.20862342, 0.36775151, 0.55267486),
       std::make_tuple(0.20675628, 0.37175775, 0.55311653),
       std::make_tuple(0.20490257, 0.37574589, 0.55353282),
       std::make_tuple(0.20306309, 0.37971644, 0.55392505),
       std::make_tuple(0.20123854, 0.38366989, 0.55429441),
       std::make_tuple(0.1994295 , 0.38760678, 0.55464205),
       std::make_tuple(0.1976365 , 0.39152762, 0.55496905),
       std::make_tuple(0.19585993, 0.39543297, 0.55527637),
       std::make_tuple(0.19410009, 0.39932336, 0.55556494),
       std::make_tuple(0.19235719, 0.40319934, 0.55583559),
       std::make_tuple(0.19063135, 0.40706148, 0.55608907),
       std::make_tuple(0.18892259, 0.41091033, 0.55632606),
       std::make_tuple(0.18723083, 0.41474645, 0.55654717),
       std::make_tuple(0.18555593, 0.4185704 , 0.55675292),
       std::make_tuple(0.18389763, 0.42238275, 0.55694377),
       std::make_tuple(0.18225561, 0.42618405, 0.5571201 ),
       std::make_tuple(0.18062949, 0.42997486, 0.55728221),
       std::make_tuple(0.17901879, 0.43375572, 0.55743035),
       std::make_tuple(0.17742298, 0.4375272 , 0.55756466),
       std::make_tuple(0.17584148, 0.44128981, 0.55768526),
       std::make_tuple(0.17427363, 0.4450441 , 0.55779216),
       std::make_tuple(0.17271876, 0.4487906 , 0.55788532),
       std::make_tuple(0.17117615, 0.4525298 , 0.55796464),
       std::make_tuple(0.16964573, 0.45626209, 0.55803034),
       std::make_tuple(0.16812641, 0.45998802, 0.55808199),
       std::make_tuple(0.1666171 , 0.46370813, 0.55811913),
       std::make_tuple(0.16511703, 0.4674229 , 0.55814141),
       std::make_tuple(0.16362543, 0.47113278, 0.55814842),
       std::make_tuple(0.16214155, 0.47483821, 0.55813967),
       std::make_tuple(0.16066467, 0.47853961, 0.55811466),
       std::make_tuple(0.15919413, 0.4822374 , 0.5580728 ),
       std::make_tuple(0.15772933, 0.48593197, 0.55801347),
       std::make_tuple(0.15626973, 0.4896237 , 0.557936  ),
       std::make_tuple(0.15481488, 0.49331293, 0.55783967),
       std::make_tuple(0.15336445, 0.49700003, 0.55772371),
       std::make_tuple(0.1519182 , 0.50068529, 0.55758733),
       std::make_tuple(0.15047605, 0.50436904, 0.55742968),
       std::make_tuple(0.14903918, 0.50805136, 0.5572505 ),
       std::make_tuple(0.14760731, 0.51173263, 0.55704861),
       std::make_tuple(0.14618026, 0.51541316, 0.55682271),
       std::make_tuple(0.14475863, 0.51909319, 0.55657181),
       std::make_tuple(0.14334327, 0.52277292, 0.55629491),
       std::make_tuple(0.14193527, 0.52645254, 0.55599097),
       std::make_tuple(0.14053599, 0.53013219, 0.55565893),
       std::make_tuple(0.13914708, 0.53381201, 0.55529773),
       std::make_tuple(0.13777048, 0.53749213, 0.55490625),
       std::make_tuple(0.1364085 , 0.54117264, 0.55448339),
       std::make_tuple(0.13506561, 0.54485335, 0.55402906),
       std::make_tuple(0.13374299, 0.54853458, 0.55354108),
       std::make_tuple(0.13244401, 0.55221637, 0.55301828),
       std::make_tuple(0.13117249, 0.55589872, 0.55245948),
       std::make_tuple(0.1299327 , 0.55958162, 0.55186354),
       std::make_tuple(0.12872938, 0.56326503, 0.55122927),
       std::make_tuple(0.12756771, 0.56694891, 0.55055551),
       std::make_tuple(0.12645338, 0.57063316, 0.5498411 ),
       std::make_tuple(0.12539383, 0.57431754, 0.54908564),
       std::make_tuple(0.12439474, 0.57800205, 0.5482874 ),
       std::make_tuple(0.12346281, 0.58168661, 0.54744498),
       std::make_tuple(0.12260562, 0.58537105, 0.54655722),
       std::make_tuple(0.12183122, 0.58905521, 0.54562298),
       std::make_tuple(0.12114807, 0.59273889, 0.54464114),
       std::make_tuple(0.12056501, 0.59642187, 0.54361058),
       std::make_tuple(0.12009154, 0.60010387, 0.54253043),
       std::make_tuple(0.11973756, 0.60378459, 0.54139999),
       std::make_tuple(0.11951163, 0.60746388, 0.54021751),
       std::make_tuple(0.11942341, 0.61114146, 0.53898192),
       std::make_tuple(0.11948255, 0.61481702, 0.53769219),
       std::make_tuple(0.11969858, 0.61849025, 0.53634733),
       std::make_tuple(0.12008079, 0.62216081, 0.53494633),
       std::make_tuple(0.12063824, 0.62582833, 0.53348834),
       std::make_tuple(0.12137972, 0.62949242, 0.53197275),
       std::make_tuple(0.12231244, 0.63315277, 0.53039808),
       std::make_tuple(0.12344358, 0.63680899, 0.52876343),
       std::make_tuple(0.12477953, 0.64046069, 0.52706792),
       std::make_tuple(0.12632581, 0.64410744, 0.52531069),
       std::make_tuple(0.12808703, 0.64774881, 0.52349092),
       std::make_tuple(0.13006688, 0.65138436, 0.52160791),
       std::make_tuple(0.13226797, 0.65501363, 0.51966086),
       std::make_tuple(0.13469183, 0.65863619, 0.5176488 ),
       std::make_tuple(0.13733921, 0.66225157, 0.51557101),
       std::make_tuple(0.14020991, 0.66585927, 0.5134268 ),
       std::make_tuple(0.14330291, 0.66945881, 0.51121549),
       std::make_tuple(0.1466164 , 0.67304968, 0.50893644),
       std::make_tuple(0.15014782, 0.67663139, 0.5065889 ),
       std::make_tuple(0.15389405, 0.68020343, 0.50417217),
       std::make_tuple(0.15785146, 0.68376525, 0.50168574),
       std::make_tuple(0.16201598, 0.68731632, 0.49912906),
       std::make_tuple(0.1663832 , 0.69085611, 0.49650163),
       std::make_tuple(0.1709484 , 0.69438405, 0.49380294),
       std::make_tuple(0.17570671, 0.6978996 , 0.49103252),
       std::make_tuple(0.18065314, 0.70140222, 0.48818938),
       std::make_tuple(0.18578266, 0.70489133, 0.48527326),
       std::make_tuple(0.19109018, 0.70836635, 0.48228395),
       std::make_tuple(0.19657063, 0.71182668, 0.47922108),
       std::make_tuple(0.20221902, 0.71527175, 0.47608431),
       std::make_tuple(0.20803045, 0.71870095, 0.4728733 ),
       std::make_tuple(0.21400015, 0.72211371, 0.46958774),
       std::make_tuple(0.22012381, 0.72550945, 0.46622638),
       std::make_tuple(0.2263969 , 0.72888753, 0.46278934),
       std::make_tuple(0.23281498, 0.73224735, 0.45927675),
       std::make_tuple(0.2393739 , 0.73558828, 0.45568838),
       std::make_tuple(0.24606968, 0.73890972, 0.45202405),
       std::make_tuple(0.25289851, 0.74221104, 0.44828355),
       std::make_tuple(0.25985676, 0.74549162, 0.44446673),
       std::make_tuple(0.26694127, 0.74875084, 0.44057284),
       std::make_tuple(0.27414922, 0.75198807, 0.4366009 ),
       std::make_tuple(0.28147681, 0.75520266, 0.43255207),
       std::make_tuple(0.28892102, 0.75839399, 0.42842626),
       std::make_tuple(0.29647899, 0.76156142, 0.42422341),
       std::make_tuple(0.30414796, 0.76470433, 0.41994346),
       std::make_tuple(0.31192534, 0.76782207, 0.41558638),
       std::make_tuple(0.3198086 , 0.77091403, 0.41115215),
       std::make_tuple(0.3277958 , 0.77397953, 0.40664011),
       std::make_tuple(0.33588539, 0.7770179 , 0.40204917),
       std::make_tuple(0.34407411, 0.78002855, 0.39738103),
       std::make_tuple(0.35235985, 0.78301086, 0.39263579),
       std::make_tuple(0.36074053, 0.78596419, 0.38781353),
       std::make_tuple(0.3692142 , 0.78888793, 0.38291438),
       std::make_tuple(0.37777892, 0.79178146, 0.3779385 ),
       std::make_tuple(0.38643282, 0.79464415, 0.37288606),
       std::make_tuple(0.39517408, 0.79747541, 0.36775726),
       std::make_tuple(0.40400101, 0.80027461, 0.36255223),
       std::make_tuple(0.4129135 , 0.80304099, 0.35726893),
       std::make_tuple(0.42190813, 0.80577412, 0.35191009),
       std::make_tuple(0.43098317, 0.80847343, 0.34647607),
       std::make_tuple(0.44013691, 0.81113836, 0.3409673 ),
       std::make_tuple(0.44936763, 0.81376835, 0.33538426),
       std::make_tuple(0.45867362, 0.81636288, 0.32972749),
       std::make_tuple(0.46805314, 0.81892143, 0.32399761),
       std::make_tuple(0.47750446, 0.82144351, 0.31819529),
       std::make_tuple(0.4870258 , 0.82392862, 0.31232133),
       std::make_tuple(0.49661536, 0.82637633, 0.30637661),
       std::make_tuple(0.5062713 , 0.82878621, 0.30036211),
       std::make_tuple(0.51599182, 0.83115784, 0.29427888),
       std::make_tuple(0.52577622, 0.83349064, 0.2881265 ),
       std::make_tuple(0.5356211 , 0.83578452, 0.28190832),
       std::make_tuple(0.5455244 , 0.83803918, 0.27562602),
       std::make_tuple(0.55548397, 0.84025437, 0.26928147),
       std::make_tuple(0.5654976 , 0.8424299 , 0.26287683),
       std::make_tuple(0.57556297, 0.84456561, 0.25641457),
       std::make_tuple(0.58567772, 0.84666139, 0.24989748),
       std::make_tuple(0.59583934, 0.84871722, 0.24332878),
       std::make_tuple(0.60604528, 0.8507331 , 0.23671214),
       std::make_tuple(0.61629283, 0.85270912, 0.23005179),
       std::make_tuple(0.62657923, 0.85464543, 0.22335258),
       std::make_tuple(0.63690157, 0.85654226, 0.21662012),
       std::make_tuple(0.64725685, 0.85839991, 0.20986086),
       std::make_tuple(0.65764197, 0.86021878, 0.20308229),
       std::make_tuple(0.66805369, 0.86199932, 0.19629307),
       std::make_tuple(0.67848868, 0.86374211, 0.18950326),
       std::make_tuple(0.68894351, 0.86544779, 0.18272455),
       std::make_tuple(0.69941463, 0.86711711, 0.17597055),
       std::make_tuple(0.70989842, 0.86875092, 0.16925712),
       std::make_tuple(0.72039115, 0.87035015, 0.16260273),
       std::make_tuple(0.73088902, 0.87191584, 0.15602894),
       std::make_tuple(0.74138803, 0.87344918, 0.14956101),
       std::make_tuple(0.75188414, 0.87495143, 0.14322828),
       std::make_tuple(0.76237342, 0.87642392, 0.13706449),
       std::make_tuple(0.77285183, 0.87786808, 0.13110864),
       std::make_tuple(0.78331535, 0.87928545, 0.12540538),
       std::make_tuple(0.79375994, 0.88067763, 0.12000532),
       std::make_tuple(0.80418159, 0.88204632, 0.11496505),
       std::make_tuple(0.81457634, 0.88339329, 0.11034678),
       std::make_tuple(0.82494028, 0.88472036, 0.10621724),
       std::make_tuple(0.83526959, 0.88602943, 0.1026459 ),
       std::make_tuple(0.84556056, 0.88732243, 0.09970219),
       std::make_tuple(0.8558096 , 0.88860134, 0.09745186),
       std::make_tuple(0.86601325, 0.88986815, 0.09595277),
       std::make_tuple(0.87616824, 0.89112487, 0.09525046),
       std::make_tuple(0.88627146, 0.89237353, 0.09537439),
       std::make_tuple(0.89632002, 0.89361614, 0.09633538),
       std::make_tuple(0.90631121, 0.89485467, 0.09812496),
       std::make_tuple(0.91624212, 0.89609127, 0.1007168 ),
       std::make_tuple(0.92610579, 0.89732977, 0.10407067),
       std::make_tuple(0.93590444, 0.8985704 , 0.10813094),
       std::make_tuple(0.94563626, 0.899815  , 0.11283773),
       std::make_tuple(0.95529972, 0.90106534, 0.11812832),
       std::make_tuple(0.96489353, 0.90232311, 0.12394051),
       std::make_tuple(0.97441665, 0.90358991, 0.13021494),
       std::make_tuple(0.98386829, 0.90486726, 0.13689671),
       std::make_tuple(0.99324789, 0.90615657, 0.1439362 )};

ColorMap::ColorMap(float min, float max, const std::vector<std::tuple<float,float,float>>& color_data) 
    : min_(min)
    , max_(max)
    , color_data_(color_data) {
    VTR_ASSERT(max_ >= min_);
}

std::tuple<float,float,float> ColorMap::color(float value) {
    VTR_ASSERT(value >= min_);
    VTR_ASSERT(value <= max_);
    float norm_value = (value - min_) / (max_ - min_);

    size_t color_idx = std::round(norm_value * (color_data_.size() - 1));

    VTR_ASSERT(color_idx < color_data_.size());

    return color_data_[color_idx];
}

InfernoColorMap::InfernoColorMap(float min, float max)
    : ColorMap(min, max, inferno_data) {}

PlasmaColorMap::PlasmaColorMap(float min, float max)
    : ColorMap(min, max, plasma_data) {}

ViridisColorMap::ViridisColorMap(float min, float max)
    : ColorMap(min, max, viridis_data) {}

} //namespace
